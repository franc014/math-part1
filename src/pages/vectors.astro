---
import Layout from '../layouts/Layout.astro';
---
<Layout title="Vectors">
    <canvas class="canvas"></canvas>
</Layout>

<style>
  .canvas {
    background-color: hsla(17, 40%, 74%);
  }
</style>

<script>
  const canvas = document.querySelector('.canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
	canvas.height  = window.innerHeight;

  let A = {
    x: 	90,
    y:  120
  };

  const offset = {
    x: canvas.width / 2,
    y: canvas.height / 2
  };

  ctx.translate(offset.x, offset.y);


  canvas.addEventListener('mousemove', (e) => {
   A.x = e.x - offset.x;
   A.y = e.y - offset.y;

   updateCoords();
  })


 

  drawCoordinateSystem();
  drawPoint(A.x, A.y,10, 'purple');



  function drawCoordinateSystem() {  
    ctx.beginPath();
    ctx.moveTo(-offset.x, 0);
    ctx.lineTo(canvas.width - offset.x, 0);
    ctx.moveTo(0, -offset.y);
    ctx.lineTo(0,canvas.height - offset.y);
    //line dash
    ctx.setLineDash([2, 2]);
    ctx.strokeStyle = 'darkpurple';
    ctx.stroke();
    ctx.setLineDash([]);
  }

  function drawPoint(x, y, r=10 , color) {
    
    ctx.beginPath();
    ctx.arc(x, y, r/2, 0, 2 * Math.PI);
    ctx.fillStyle = color;
    ctx.fill();

  }

  function updateCoords() {
    ctx.clearRect(-offset.x, -offset.y, canvas.width, canvas.height);
    drawCoordinateSystem();
    drawPoint(A.x, A.y, 20,'purple');
    const polar = toPolar(A);

    console.log(polar);

    const cartesian = toCartesian(polar);
    console.log({cartesian});
    drawPoint(cartesian.x, cartesian.y, 8,'lightblue');
    
  }
  
  function toCartesian({magnitude,direction}) {
    return {
      x: magnitude * Math.cos(direction),
      y: magnitude * Math.sin(direction)
    }
  }

  function toPolar({x,y}) {

    console.log({x,y});
    return {
      magnitude: magnitude({x,y}),
      direction: direction({x,y})
    }
  };

  function magnitude({x,y}) {
    return Math.hypot(x, y);
  }

  function direction({x,y}) {
    return Math.atan2( y, x );
    //return Math.atan( y / x );
  }
  
  
</script>

